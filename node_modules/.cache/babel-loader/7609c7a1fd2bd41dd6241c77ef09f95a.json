{"ast":null,"code":"var _jsxFileName = \"/Users/antonrybalkin/Projects/testtask/src/components/ComponentForm.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useRef, useState, useContext } from \"react\";\nimport ComponentRadioGroup from \"./ComponentRadioGroup\";\nimport ComponentInput from \"./ComponentInput\";\nimport ComponentFileLoader from \"./ComponentFileLoader\";\nimport Succes from \"../assets/success-image.svg\";\nimport ComponentPhoneInput from \"./ComponentPhoneInput\";\nimport { validateEmail, validateName, validationImg, validateForm } from \"./validate\";\nimport { LocalContext } from \"./Context\";\n/**\n *  component Form who render form and handle it\n * @returns \n */\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Form = () => {\n  _s();\n\n  const [token, setToken] = useState(\"\");\n  const [status, setStatus] = useState(false);\n  const form = useRef();\n  const {\n    setRe_Render\n  } = useContext(LocalContext);\n  /**\n   * hook what get token\n   */\n\n  useEffect(() => {\n    fetch('https://frontend-test-assignment-api.abz.agency/api/v1/token').then(function (response) {\n      return response.json();\n    }).then(function (data) {\n      setToken(data.token);\n    });\n  });\n  /**\n   * callback \n   * @param {Event} e \n   * @returns \n   */\n\n  async function handleSubmit(e) {\n    e.preventDefault();\n    let formData = new FormData(form.current);\n    formData.set(\"phone\", \"+\" + document.querySelector(\"input[name='phone']\").value.replace(/[^\\d]/g, ''));\n    let status = await validateForm(formData, {\n      email: \"email\",\n      name: \"name\",\n      position_id: \"position_id\",\n      phone: \"phone\",\n      photo: \"photo\"\n    });\n\n    if (status.succeed) {\n      fetch('https://frontend-test-assignment-api.abz.agency/api/v1/users', {\n        method: 'POST',\n        body: formData,\n        headers: {\n          'Token': token\n        }\n      }).then(function (response) {\n        return response.json();\n      }).then(function (data) {\n        if (data.success) {\n          setStatus(true);\n          document.querySelector(\".registration_title\").style.display = \"none\";\n          setRe_Render(true);\n        } else {}\n      });\n    }\n  }\n\n  if (status == false) {\n    return /*#__PURE__*/_jsxDEV(\"form\", {\n      className: \"registration_form\",\n      ref: form,\n      onSubmit: handleSubmit,\n      noValidate: true,\n      children: [/*#__PURE__*/_jsxDEV(ComponentInput, {\n        type: \"text\",\n        name: \"name\",\n        reqired: true,\n        validator: validateName,\n        placeholder: \"Your name\"\n      }, \"name\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(ComponentInput, {\n        type: \"email\",\n        name: \"email\",\n        reqired: true,\n        validator: validateEmail,\n        placeholder: \"Email\"\n      }, \"email\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(ComponentPhoneInput, {\n        name: \"phone\",\n        reqired: true,\n        placeholder: \"Phone\"\n      }, \"phone\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        className: \"registration_roleblock\",\n        htmlFor: \"role\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"registration_roletitle\",\n          children: \"Select your position\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(ComponentRadioGroup, {\n          id: \"role\",\n          name: \"position_id\",\n          reqired: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(ComponentFileLoader, {\n        validator: validationImg,\n        name: \"photo\",\n        reqired: true,\n        placeholer: \"Upload your photo\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"submit\",\n        className: \"registration_submit\",\n        value: \"Sign up\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 13\n    }, this);\n  } else {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"registration_succes\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"registration_succestitle\",\n        children: \"User successfully registered\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n        src: Succes,\n        className: \"registration_succesimg\",\n        alt: \"succes\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 13\n    }, this);\n  }\n};\n\n_s(Form, \"ecmvflg24d6S+ibjjV19JvR6fJk=\");\n\n_c = Form;\nexport default Form;\n\nvar _c;\n\n$RefreshReg$(_c, \"Form\");","map":{"version":3,"names":["React","useEffect","useRef","useState","useContext","ComponentRadioGroup","ComponentInput","ComponentFileLoader","Succes","ComponentPhoneInput","validateEmail","validateName","validationImg","validateForm","LocalContext","Form","token","setToken","status","setStatus","form","setRe_Render","fetch","then","response","json","data","handleSubmit","e","preventDefault","formData","FormData","current","set","document","querySelector","value","replace","email","name","position_id","phone","photo","succeed","method","body","headers","success","style","display"],"sources":["/Users/antonrybalkin/Projects/testtask/src/components/ComponentForm.js"],"sourcesContent":["import React, {useEffect, useRef, useState, useContext} from \"react\";\nimport ComponentRadioGroup from \"./ComponentRadioGroup\";\nimport ComponentInput from \"./ComponentInput\"\nimport ComponentFileLoader from \"./ComponentFileLoader\";\nimport Succes from \"../assets/success-image.svg\";\nimport ComponentPhoneInput from \"./ComponentPhoneInput\";\nimport {validateEmail, validateName, validationImg, validateForm} from \"./validate\";\nimport {LocalContext} from \"./Context\";\n/**\n *  component Form who render form and handle it\n * @returns \n */\nconst Form = () => {\n    const [token,\n        setToken] = useState(\"\");\n    const [status,\n        setStatus] = useState(false);\n    const form = useRef();\n    const {setRe_Render} = useContext(LocalContext);\n /**\n  * hook what get token\n  */\n    useEffect(() => {\n        fetch('https://frontend-test-assignment-api.abz.agency/api/v1/token')\n            .then(function (response) {\n                return response.json();\n            })\n            .then(function (data) {\n                setToken(data.token)\n            })\n    })\n/**\n * callback \n * @param {Event} e \n * @returns \n */\n    async function handleSubmit(e) {\n        e.preventDefault();\n\n        let formData = new FormData(form.current);\n        formData.set(\"phone\",\"+\"+document.querySelector(\"input[name='phone']\").value.replace(/[^\\d]/g, ''))\n        let status = await validateForm(formData, {\n            email: \"email\",\n            name: \"name\",\n            position_id: \"position_id\",\n            phone: \"phone\",\n            photo: \"photo\"\n        });\n         if (status.succeed) {\n\n            fetch('https://frontend-test-assignment-api.abz.agency/api/v1/users', {\n                    method: 'POST',\n                    body: formData,\n                    headers: {\n                        'Token': token\n                    }\n                })\n                .then(function (response) {\n                    return response.json();\n                })\n                .then(function (data) {\n                    if (data.success) {\n                        setStatus(true)\n                        document\n                            .querySelector(\".registration_title\")\n                            .style\n                            .display = \"none\";\n                        setRe_Render(true);\n                    } else {}\n                })\n         }\n    }\n\n    if (status == false) {\n        return (\n            <form\n                className={\"registration_form\"}\n                ref={form}\n                onSubmit={handleSubmit}\n                noValidate>\n                <ComponentInput\n                    key={\"name\"}\n                    type={\"text\"}\n                    name={\"name\"}\n                    reqired={true}\n                    validator={validateName}\n                    placeholder={\"Your name\"}></ComponentInput>\n                <ComponentInput\n                    key={\"email\"}\n                    type={\"email\"}\n                    name={\"email\"}\n                    reqired={true}\n                    validator={validateEmail}\n                    placeholder={\"Email\"}></ComponentInput>\n                <ComponentPhoneInput\n                    key={\"phone\"}\n                    name={\"phone\"}\n                    reqired={true}\n                    placeholder={\"Phone\"}></ComponentPhoneInput>\n                <label className={\"registration_roleblock\"} htmlFor={\"role\"}>\n                    <p className={\"registration_roletitle\"}>Select your position</p>\n                    <ComponentRadioGroup id={\"role\"} name={\"position_id\"} reqired={true}></ComponentRadioGroup>\n                </label>\n                <ComponentFileLoader\n                    validator={validationImg}\n                    name={\"photo\"}\n                    reqired={true}\n                    placeholer={\"Upload your photo\"}/>\n                <input type=\"submit\" className=\"registration_submit\" value=\"Sign up\"/>\n            </form>\n        )\n    } else {\n        return (\n            <div className={\"registration_succes\"}>\n                <h2 className={\"registration_succestitle\"}>User successfully registered</h2>\n                <img src={Succes} className={\"registration_succesimg\"} alt=\"succes\"></img>\n            </div>\n        )\n    }\n}\nexport default Form;"],"mappings":"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"},"metadata":{},"sourceType":"module"}