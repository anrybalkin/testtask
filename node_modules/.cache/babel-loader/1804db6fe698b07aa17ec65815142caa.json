{"ast":null,"code":"import _slicedToArray from\"/Users/antonrybalkin/Projects/testtask/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useRef,useState,useContext}from'react';import UserCard from'./ComponentUser';import Button from'./ComponentButtton';import{LocalContext}from'./Context';import ComponentPreloader from\"./ComponentPreloader\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Users=function Users(props){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),users=_useState2[0],setUsers=_useState2[1];var _useState3=useState(1),_useState4=_slicedToArray(_useState3,2),page=_useState4[0],setPage=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),pages=_useState6[0],setPages=_useState6[1];var btn=useRef();var _useContext=useContext(LocalContext),re_render=_useContext.re_render,setRe_Render=_useContext.setRe_Render;useEffect(function(){if(users==null&&(pages==null||pages>page)){fetch(\"https://frontend-test-assignment-api.abz.agency/api/v1/users?page=\"+page+\"&count=6\").then(function(response){return response.json();}).then(function(data){setUsers(data.users);setPage(2);setPages(data.total_pages);});}if(pages-page==1){btn.current.style.display=\"none\";}if(re_render){console.log(re_render);setRe_Render(false);setPage(2);setUsers(\"\");fetch(\"https://frontend-test-assignment-api.abz.agency/api/v1/users?page=\"+1+\"&count=6\").then(function(response){return response.json();}).then(function(data){setUsers(data.users);setPages(data.total_pages);});}});function showMore(){fetch(\"https://frontend-test-assignment-api.abz.agency/api/v1/users?page=\"+page+\"&count=6\").then(function(response){return response.json();}).then(function(data){setUsers(users.concat(data.users));setPage(page+1);});}if(users!=null&&users!=\"\"){return/*#__PURE__*/_jsxs(\"section\",{className:\"users\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"users_title\",children:\"Working with GET request\"}),/*#__PURE__*/_jsx(\"div\",{className:\"users_cards\",children:users.map(function(el){return/*#__PURE__*/_jsx(UserCard,{data:el},el.id);})}),/*#__PURE__*/_jsx(Button,{type:\"users_button\",ref:btn,onClick:showMore,children:\"Show more\"})]});}else{return/*#__PURE__*/_jsxs(\"section\",{className:\"users\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"users_title\",children:\"Working with GET request\"}),/*#__PURE__*/_jsx(\"div\",{className:\"users_cards\",children:/*#__PURE__*/_jsx(ComponentPreloader,{})}),/*#__PURE__*/_jsx(Button,{type:\"users_button\",ref:btn,onClick:showMore,children:\"Show more\"})]});}};export default Users;","map":{"version":3,"names":["React","useEffect","useRef","useState","useContext","UserCard","Button","LocalContext","ComponentPreloader","Users","props","users","setUsers","page","setPage","pages","setPages","btn","re_render","setRe_Render","fetch","then","response","json","data","total_pages","current","style","display","console","log","showMore","concat","map","el","id"],"sources":["/Users/antonrybalkin/Projects/testtask/src/components/ComponentUsers.js"],"sourcesContent":["import React, {useEffect, useRef, useState,useContext} from 'react';\nimport UserCard from './ComponentUser';\nimport Button from './ComponentButtton';\nimport {LocalContext} from './Context';\nimport ComponentPreloader from \"./ComponentPreloader\";\n\n\nconst Users = (props) => {\n    const [users,\n        setUsers] = useState(null);\n    const [page,\n        setPage] = useState(1);\n    const [pages,\n        setPages] = useState(null);\n    let btn = useRef()\n    const { re_render,setRe_Render } = useContext(LocalContext);\n\n    useEffect(() => {\n        if (users == null && (pages == null || pages > page)) {\n            fetch(\"https://frontend-test-assignment-api.abz.agency/api/v1/users?page=\" + page + \"&count=6\").then(response => {\n                return response.json()\n            }).then(data => {\n                setUsers(data.users);\n                setPage(2)\n                setPages(data.total_pages)\n            })\n        }\n        if (pages - page == 1) {\n            btn.current.style.display = \"none\";\n        }\n        if(re_render)\n        {\n            console.log(re_render)\n            setRe_Render(false);\n            setPage(2);\n            setUsers(\"\");\n            fetch(\"https://frontend-test-assignment-api.abz.agency/api/v1/users?page=\" + 1 + \"&count=6\").then(response => {\n                return response.json()\n            }).then(data => {\n                setUsers(data.users);\n                setPages(data.total_pages)\n                \n            })\n\n        }\n    })\n\n    function showMore() {\n        fetch(\"https://frontend-test-assignment-api.abz.agency/api/v1/users?page=\" + page + \"&count=6\").then(response => {\n            return response.json()\n        }).then(data => {\n            setUsers(users.concat(data.users));\n            setPage(page + 1)\n        })\n    }\n    if (users != null&&users != \"\") {\n        return (\n            <section className={\"users\"}>\n                <h2 className={\"users_title\"}>\n                    Working with GET request\n                </h2>\n                <div className={\"users_cards\"}>\n                    {users.map(el => {\n                        return <UserCard key={el.id} data={el}></UserCard>\n                    })}\n                </div>\n                <Button type={\"users_button\"} ref={btn} onClick={showMore}>Show more</Button>\n            </section>\n        )\n    } else {\n        return(\n            <section className={\"users\"}>\n                    <h2 className={\"users_title\"}>\n                        Working with GET request\n                    </h2>\n                    <div className={\"users_cards\"}>\n                        <ComponentPreloader/>\n                    </div>\n                    <Button type={\"users_button\"} ref={btn} onClick={showMore}>Show more</Button>\n                </section>)\n    }\n\n}\nexport default Users;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}